<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quarterly Sales Report by Region - 2024</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        h1 {
            color: #2c3e50;
            margin-bottom: 1.5rem;
        }

        .table-container {
            overflow-x: auto;
            margin-bottom: 2rem;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1rem;
        }

        caption {
            font-size: 1.2rem;
            font-weight: bold;
            text-align: left;
            padding: 0.75rem;
            background-color: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
            color: #495057;
        }

        th, td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #dee2e6;
        }

        th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #495057;
        }

        .region-header {
            background-color: #e9ecef;
        }

        tbody tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        tbody tr:hover {
            background-color: #e9ecef;
        }

        .highlight {
            background-color: #fff3cd !important;
        }

        .total-row {
            font-weight: bold;
            background-color: #e9ecef;
        }

        .controls {
            margin-bottom: 1rem;
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        button {
            background-color: #4a6fa5;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
        }

        button:hover {
            background-color: #3a5a80;
        }

        button:focus {
            outline: 3px solid #90b3e9;
            outline-offset: 2px;
        }

        select {
            padding: 0.5rem;
            font-size: 1rem;
            border-radius: 4px;
            border: 1px solid #ced4da;
        }

        select:focus {
            outline: 3px solid #90b3e9;
            border-color: #4a6fa5;
        }

        /* Skip link styles */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: #4a6fa5;
            color: white;
            padding: 8px;
            z-index: 100;
            transition: top 0.3s;
        }

        .skip-link:focus {
            top: 0;
        }

        @media (max-width: 768px) {
            th, td {
                padding: 0.5rem;
                font-size: 0.9rem;
            }
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }
    </style>
</head>
<body>
    <!-- Skip link for keyboard users -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <main id="main-content">
        <h1>Quarterly Sales Report by Region - 2024</h1>
        
        <div class="controls">
            <button id="toggle-totals" aria-pressed="false">Show/Hide Totals</button>
            <select id="highlight-quarter" aria-label="Highlight a specific quarter">
                <option value="">Highlight a quarter...</option>
                <option value="q1">Q1 (Jan-Mar)</option>
                <option value="q2">Q2 (Apr-Jun)</option>
                <option value="q3">Q3 (Jul-Sep)</option>
                <option value="q4">Q4 (Oct-Dec)</option>
            </select>
        </div>
        
        <div class="table-container">
            <!-- Table with caption and multiple headers -->
            <table id="sales-table" aria-describedby="table-description">
                <caption>Annual Sales Figures by Region and Quarter ($USD thousands)</caption>
                <thead>
                    <tr>
                        <th scope="col">Region</th>
                        <th scope="col">Q1 (Jan-Mar)</th>
                        <th scope="col">Q2 (Apr-Jun)</th>
                        <th scope="col">Q3 (Jul-Sep)</th>
                        <th scope="col">Q4 (Oct-Dec)</th>
                        <th scope="col" class="total-column">Annual Total</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <th scope="row" class="region-header">North America</th>
                        <td data-quarter="q1">432.8</td>
                        <td data-quarter="q2">517.3</td>
                        <td data-quarter="q3">489.6</td>
                        <td data-quarter="q4">625.2</td>
                        <td class="total-column">2064.9</td>
                    </tr>
                    <tr>
                        <th scope="row" class="region-header">Europe</th>
                        <td data-quarter="q1">351.6</td>
                        <td data-quarter="q2">387.2</td>
                        <td data-quarter="q3">329.5</td>
                        <td data-quarter="q4">412.7</td>
                        <td class="total-column">1481.0</td>
                    </tr>
                    <tr>
                        <th scope="row" class="region-header">Asia Pacific</th>
                        <td data-quarter="q1">287.4</td>
                        <td data-quarter="q2">318.9</td>
                        <td data-quarter="q3">396.2</td>
                        <td data-quarter="q4">378.5</td>
                        <td class="total-column">1381.0</td>
                    </tr>
                    <tr>
                        <th scope="row" class="region-header">Latin America</th>
                        <td data-quarter="q1">129.3</td>
                        <td data-quarter="q2">142.7</td>
                        <td data-quarter="q3">157.8</td>
                        <td data-quarter="q4">168.4</td>
                        <td class="total-column">598.2</td>
                    </tr>
                    <tr>
                        <th scope="row" class="region-header">Middle East & Africa</th>
                        <td data-quarter="q1">98.7</td>
                        <td data-quarter="q2">112.4</td>
                        <td data-quarter="q3">123.9</td>
                        <td data-quarter="q4">136.8</td>
                        <td class="total-column">471.8</td>
                    </tr>
                    <tr class="total-row">
                        <th scope="row">Quarterly Totals</th>
                        <td data-quarter="q1">1299.8</td>
                        <td data-quarter="q2">1478.5</td>
                        <td data-quarter="q3">1497.0</td>
                        <td data-quarter="q4">1721.6</td>
                        <td class="total-column">5996.9</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div id="table-description" class="sr-only">
            This table shows quarterly sales figures for different regions around the world. The rows represent regions, and columns represent fiscal quarters of 2024. The rightmost column shows annual totals for each region, while the bottom row shows quarterly totals across all regions.
        </div>

        <section aria-labelledby="data-insights">
            <h2 id="data-insights">Key Insights</h2>
            <ul>
                <li>North America continues to be our strongest market, with steady growth throughout the year.</li>
                <li>Q4 showed the highest sales performance across all regions.</li>
                <li>Asia Pacific demonstrated remarkable growth in Q3, surpassing Europe for that quarter.</li>
                <li>All regions showed year-over-year improvement compared to 2023 sales figures.</li>
            </ul>
        </section>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Function to toggle total columns/rows visibility
            const toggleTotalsButton = document.getElementById('toggle-totals');
            const totalColumns = document.querySelectorAll('.total-column');
            const totalRow = document.querySelector('.total-row');
            
            let totalsVisible = true;
            
            toggleTotalsButton.addEventListener('click', function() {
                totalsVisible = !totalsVisible;
                
                // Update button state
                this.setAttribute('aria-pressed', !totalsVisible);
                
                // Toggle visibility
                totalColumns.forEach(cell => {
                    cell.style.display = totalsVisible ? '' : 'none';
                });
                
                totalRow.style.display = totalsVisible ? '' : 'none';
                
                // Announce change to screen readers
                const announcement = document.createElement('div');
                announcement.setAttribute('role', 'status');
                announcement.classList.add('sr-only');
                announcement.textContent = totalsVisible ? 'Totals are now visible' : 'Totals are now hidden';
                document.body.appendChild(announcement);
                
                // Remove announcement after screen reader has time to read it
                setTimeout(() => {
                    document.body.removeChild(announcement);
                }, 3000);
            });
            
            // Highlight quarter functionality
            const highlightSelect = document.getElementById('highlight-quarter');
            
            highlightSelect.addEventListener('change', function() {
                // Clear all highlights first
                document.querySelectorAll('[data-quarter]').forEach(cell => {
                    cell.classList.remove('highlight');
                });
                
                // Apply highlight to selected quarter
                const selectedQuarter = this.value;
                if (selectedQuarter) {
                    document.querySelectorAll(`[data-quarter="${selectedQuarter}"]`).forEach(cell => {
                        cell.classList.add('highlight');
                    });
                    
                    // Announce to screen readers
                    const announcement = document.createElement('div');
                    announcement.setAttribute('role', 'status');
                    announcement.classList.add('sr-only');
                    
                    // Map quarter values to readable names
                    const quarterNames = {
                        'q1': 'Quarter 1, January through March',
                        'q2': 'Quarter 2, April through June',
                        'q3': 'Quarter 3, July through September',
                        'q4': 'Quarter 4, October through December'
                    };
                    
                    announcement.textContent = `Highlighting ${quarterNames[selectedQuarter]} data`;
                    document.body.appendChild(announcement);
                    
                    // Remove announcement after screen reader has time to read it
                    setTimeout(() => {
                        document.body.removeChild(announcement);
                    }, 3000);
                }
            });
            
            // Add keyboard navigation for the table
            const salesTable = document.getElementById('sales-table');
            const cells = salesTable.querySelectorAll('th, td');
            
            cells.forEach((cell, index) => {
                cell.setAttribute('tabindex', '0');
                
                cell.addEventListener('keydown', function(e) {
                    let targetCell;
                    const rowIndex = this.parentElement.rowIndex;
                    const cellIndex = this.cellIndex;
                    const rows = salesTable.rows;
                    
                    // Navigate with arrow keys
                    switch(e.key) {
                        case 'ArrowUp':
                            if (rowIndex > 0) {
                                targetCell = rows[rowIndex - 1].cells[cellIndex];
                            }
                            break;
                        case 'ArrowDown':
                            if (rowIndex < rows.length - 1) {
                                targetCell = rows[rowIndex + 1].cells[cellIndex];
                            }
                            break;
                        case 'ArrowLeft':
                            if (cellIndex > 0) {
                                targetCell = rows[rowIndex].cells[cellIndex - 1];
                            }
                            break;
                        case 'ArrowRight':
                            if (cellIndex < this.parentElement.cells.length - 1) {
                                targetCell = rows[rowIndex].cells[cellIndex + 1];
                            }
                            break;
                        case 'Home':
                            if (e.ctrlKey) {
                                // Go to first cell of the table
                                targetCell = rows[0].cells[0];
                            } else {
                                // Go to first cell of the row
                                targetCell = rows[rowIndex].cells[0];
                            }
                            break;
                        case 'End':
                            if (e.ctrlKey) {
                                // Go to last cell of the table
                                const lastRow = rows[rows.length - 1];
                                targetCell = lastRow.cells[lastRow.cells.length - 1];
                            } else {
                                // Go to last cell of the row
                                targetCell = rows[rowIndex].cells[rows[rowIndex].cells.length - 1];
                            }
                            break;
                        default:
                            return; // Exit for other keys
                    }
                    
                    if (targetCell) {
                        e.preventDefault();
                        targetCell.focus();
                    }
                });
            });
        });
    </script>
</body>
</html>